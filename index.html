<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Comparatif SLR - Analyse des Performances</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #366092 0%, #2a4a73 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .export-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .export-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.6);
        }

        .export-btn:active {
            transform: translateY(0);
        }

        .export-btn svg {
            width: 20px;
            height: 20px;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 50px;
        }

        .section h2 {
            color: #366092;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #366092;
        }

        .section h3 {
            color: #2a4a73;
            font-size: 1.5em;
            margin: 30px 0 15px 0;
        }

        .summary-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .summary-box p {
            margin: 10px 0;
            font-size: 1.1em;
        }

        .summary-box strong {
            color: #366092;
        }

        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: #366092;
        }

        .card-title {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card-value {
            font-size: 2em;
            font-weight: bold;
            color: #366092;
            margin: 10px 0;
        }

        .card-label {
            font-size: 0.9em;
            color: #888;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-danger {
            background: #f8d7da;
            color: #721c24;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
            font-size: 0.9em;
        }

        thead {
            background: #366092;
            color: white;
        }

        th {
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.85em;
        }

        td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .slr-name {
            text-align: left;
            font-weight: 500;
            color: #333;
        }

        .avg-row {
            background: #f0f0f0;
            font-weight: bold;
        }

        .avg-row td {
            border-top: 2px solid #366092;
        }

        .legends {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .conclusions {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 10px;
            border-left: 5px solid #366092;
        }

        .conclusions ul {
            list-style: none;
            padding-left: 0;
        }

        .conclusions li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .conclusions li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #4CAF50;
            font-weight: bold;
            font-size: 1.3em;
        }

        .objectives {
            background: #fff9c4;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #f57f17;
            margin: 20px 0;
        }

        .objectives p {
            margin: 5px 0;
        }

        .highlight-new {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
        }

        @media print {
            .export-btn {
                display: none;
            }
            
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .export-btn {
                position: static;
                margin: 20px auto;
                display: flex;
                width: fit-content;
            }
            
            .content {
                padding: 20px;
            }
            
            table {
                font-size: 0.75em;
            }
            
            th, td {
                padding: 6px 4px;
            }
        }
    </style>
</head>
<body>
    <button class="export-btn" onclick="exportToPDF()">
        <svg fill="currentColor" viewBox="0 0 20 20">
            <path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/>
        </svg>
        Exporter en PDF
    </button>

    <div class="container" id="report-content">
        <div class="header">
            <h1>Rapport Comparatif des Performances</h1>
            <p>Screening Syst√©matique de Litt√©rature (SLR)</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Date: 3 Novembre 2025</p>
        </div>

            <!-- TABLEAU COMPARATIF -->
            <div class="content">
                <!-- R√âSUM√â EX√âCUTIF -->
                <div class="section">
                    <h2>üìä R√©sum√© Ex√©cutif</h2>
                    <div class="summary-box">
                        <p><strong>Objectif:</strong> Comparer les performances de diff√©rentes approches pour le screening automatis√© d'√©tudes biom√©dicales dans le cadre de revues syst√©matiques de litt√©rature (SLR).</p>
                        
                        <p style="margin-top: 20px;"><strong>Approches compar√©es:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Picos-ref:</strong> Mod√®le Qwen avec crit√®res PICOS uniquement (Massinissa)</li>
                            <li><strong>PICOS+SUJET:</strong> Mod√®le Qwen avec PICOS + sujet de recherche (Massinissa)</li>
                            <li><strong>ML:</strong> Mod√®le ML (Machine Learning)</li>
                            <li><strong>Qwen (Mass.):</strong> Qwen de Massinissa</li>
                            <li><strong>Qwen Canada:</strong> Qwen version Canada</li>
                            <li><strong>GPT-4o:</strong> OpenAI GPT-4o</li>
                            <li><strong style="color: #4CAF50;">P3-Marie:</strong> Votre prompt optimis√© pour le rappel avec Qwen - PICOS uniquement</li>
                        </ul>
                    </div>
            
                    <div class="objectives">
                        <p><strong>üéØ Objectifs de Performance:</strong></p>
                        <p>‚Ä¢ <strong>TPR (Sensibilit√©/Recall):</strong> ‚â• 80% - Capacit√© √† identifier correctement les √©tudes pertinentes</p>
                        <p>‚Ä¢ <strong>TNR (Sp√©cificit√©):</strong> ‚â• 70% - Capacit√© √† exclure correctement les √©tudes non pertinentes</p>
                    </div>
                </div>
        
            
                <!-- TABLEAU 14 SLR COMPL√àTES -->
                <div class="section">
                    <h2>üìã R√©sultats Complets - 14 SLR (Tous Mod√®les Compar√©s)</h2>
                    
                    <p style="margin-bottom: 20px; color: #666;">
                        Ce tableau pr√©sente une comparaison exhaustive de tous les mod√®les test√©s sur 14 SLR.
                    </p>

                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th rowspan="2" style="min-width: 250px;">SLR</th>
                                    <th rowspan="2" style="background: #e8eaf6;">Taille</th>
                                    <th colspan="2" style="background: #5a9bd5;">Picos-ref</th>
                                    <th colspan="2" style="background: #70ad47;">PICOS+SUJET</th>
                                    <th colspan="2" style="background: #b39ddb;">ML</th>
                                    <th colspan="2" style="background: #ff9800;">Qwen<br>(Mass.)</th>
                                    <th colspan="2" style="background: #ab47bc;">Qwen<br>Canada</th>
                                    <th colspan="2" style="background: #26a69a;">GPT-4o</th>
                                    <th colspan="2" style="background: #4CAF50;">P3<br>(Votre)</th>
                                </tr>
                                <tr>
                                    <th style="background: #5a9bd5;">TPR</th>
                                    <th style="background: #5a9bd5;">TNR</th>
                                    <th style="background: #70ad47;">TPR</th>
                                    <th style="background: #70ad47;">TNR</th>
                                    <th style="background: #b39ddb;">TPR</th>
                                    <th style="background: #b39ddb;">TNR</th>
                                    <th style="background: #ff9800;">TPR</th>
                                    <th style="background: #ff9800;">TNR</th>
                                    <th style="background: #ab47bc;">TPR</th>
                                    <th style="background: #ab47bc;">TNR</th>
                                    <th style="background: #26a69a;">TPR</th>
                                    <th style="background: #26a69a;">TNR</th>
                                    <th style="background: #4CAF50;">TPR</th>
                                    <th style="background: #4CAF50;">TNR</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="slr-name">CICATRYL_SOTA_SD</td>
                                    <td style="text-align: center;">147</td>
                                    <td>0.87</td>
                                    <td>0.50</td>
                                    <td>0.83</td>
                                    <td>0.68</td>
                                    <td>0.24</td>
                                    <td>0.82</td>
                                    <td>0.87</td>
                                    <td>0.50</td>
                                    <td>0.49</td>
                                    <td>0.50</td>
                                    <td>0.90</td>
                                    <td>0.68</td>
                                    <td>0.80</td>
                                    <td>0.75</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">CLINICAL_DATA_RM_GM</td>
                                    <td style="text-align: center;">25</td>
                                    <td>1.00</td>
                                    <td>0.17</td>
                                    <td>1.00</td>
                                    <td>0.34</td>
                                    <td>1.00</td>
                                    <td>0.43</td>
                                    <td>1.00</td>
                                    <td>0.17</td>
                                    <td>0.50</td>
                                    <td>0.40</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>1.00</td>
                                    <td>0.22</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">DIA_LARM_BS</td>
                                    <td style="text-align: center;">68</td>
                                    <td>0.72</td>
                                    <td>0.62</td>
                                    <td>0.83</td>
                                    <td>0.55</td>
                                    <td>0.75</td>
                                    <td>0.46</td>
                                    <td>1.00</td>
                                    <td>0.51</td>
                                    <td>0.33</td>
                                    <td>0.51</td>
                                    <td>0.17</td>
                                    <td>0.85</td>
                                    <td>0.92</td>
                                    <td>0.82</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">LUNG_CANCER_LB</td>
                                    <td style="text-align: center;">218</td>
                                    <td>0.96</td>
                                    <td>0.62</td>
                                    <td>0.94</td>
                                    <td>0.71</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>0.98</td>
                                    <td>0.69</td>
                                    <td>0.50</td>
                                    <td>0.63</td>
                                    <td>0.94</td>
                                    <td>0.63</td>
                                    <td>0.91</td>
                                    <td>0.74</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">PCL_EL</td>
                                    <td style="text-align: center;">215</td>
                                    <td>0.48</td>
                                    <td>0.77</td>
                                    <td>0.48</td>
                                    <td>0.87</td>
                                    <td>0.72</td>
                                    <td>0.33</td>
                                    <td>0.45</td>
                                    <td>0.80</td>
                                    <td>0.31</td>
                                    <td>0.78</td>
                                    <td>0.28</td>
                                    <td>0.90</td>
                                    <td>0.38</td>
                                    <td>0.88</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">REVIEW_HRV_ACIDOSE_AW</td>
                                    <td style="text-align: center;">801</td>
                                    <td>1.00</td>
                                    <td>0.36</td>
                                    <td>0.86</td>
                                    <td>0.65</td>
                                    <td>1.00</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.36</td>
                                    <td>0.64</td>
                                    <td>0.34</td>
                                    <td>1.00</td>
                                    <td>0.59</td>
                                    <td>0.92</td>
                                    <td>0.66</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">REVIEW_RESORBABLE_POLYCAPROLACTONE_EL</td>
                                    <td style="text-align: center;">185</td>
                                    <td>0.91</td>
                                    <td>0.44</td>
                                    <td>0.93</td>
                                    <td>0.48</td>
                                    <td>0.64</td>
                                    <td>0.60</td>
                                    <td>0.95</td>
                                    <td>0.64</td>
                                    <td>0.63</td>
                                    <td>0.48</td>
                                    <td>0.98</td>
                                    <td>0.57</td>
                                    <td>0.95</td>
                                    <td>0.41</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">SOTA_ICD_BS</td>
                                    <td style="text-align: center;">6</td>
                                    <td>0.75</td>
                                    <td>0.00</td>
                                    <td>1.00</td>
                                    <td>0.50</td>
                                    <td>0.75</td>
                                    <td>0.50</td>
                                    <td>0.50</td>
                                    <td>0.00</td>
                                    <td>0.25</td>
                                    <td>0.00</td>
                                    <td>0.75</td>
                                    <td>0.50</td>
                                    <td>0.75</td>
                                    <td>0.00</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">SOTA_ICD_COMPR_BS</td>
                                    <td style="text-align: center;">33</td>
                                    <td>0.77</td>
                                    <td>0.25</td>
                                    <td>0.85</td>
                                    <td>0.55</td>
                                    <td>0.90</td>
                                    <td>0.45</td>
                                    <td>0.77</td>
                                    <td>0.25</td>
                                    <td>0.77</td>
                                    <td>0.35</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>0.85</td>
                                    <td>0.60</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">SOTA_RM_GH</td>
                                    <td style="text-align: center;">172</td>
                                    <td>1.00</td>
                                    <td>0.02</td>
                                    <td>1.00</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.52</td>
                                    <td>1.00</td>
                                    <td>0.13</td>
                                    <td>0.77</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.01</td>
                                    <td>0.95</td>
                                    <td>0.27</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">Spring_thread_LW</td>
                                    <td style="text-align: center;">217</td>
                                    <td>0.94</td>
                                    <td>0.55</td>
                                    <td>0.82</td>
                                    <td>0.79</td>
                                    <td>0.94</td>
                                    <td>0.56</td>
                                    <td>0.94</td>
                                    <td>0.55</td>
                                    <td>0.44</td>
                                    <td>0.58</td>
                                    <td>0.96</td>
                                    <td>0.57</td>
                                    <td>0.72</td>
                                    <td>0.87</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">Tachy_SOTA_LW</td>
                                    <td style="text-align: center;">367</td>
                                    <td>0.78</td>
                                    <td>0.73</td>
                                    <td>0.02</td>
                                    <td>0.98</td>
                                    <td>0.84</td>
                                    <td>0.69</td>
                                    <td>0.78</td>
                                    <td>0.73</td>
                                    <td>0.28</td>
                                    <td>0.66</td>
                                    <td>0.73</td>
                                    <td>0.75</td>
                                    <td>0.02</td>
                                    <td>1.00</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">Teranga_2023_LW</td>
                                    <td style="text-align: center;">367</td>
                                    <td>0.77</td>
                                    <td>0.73</td>
                                    <td>0.06</td>
                                    <td>0.99</td>
                                    <td>0.84</td>
                                    <td>0.69</td>
                                    <td>0.77</td>
                                    <td>0.73</td>
                                    <td>0.35</td>
                                    <td>0.68</td>
                                    <td>0.76</td>
                                    <td>0.77</td>
                                    <td>0.06</td>
                                    <td>1.00</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">WHEELCHAIR_BS</td>
                                    <td style="text-align: center;">51</td>
                                    <td>1.00</td>
                                    <td>0.31</td>
                                    <td>0.41</td>
                                    <td>0.84</td>
                                    <td>0.67</td>
                                    <td>0.62</td>
                                    <td>1.00</td>
                                    <td>0.08</td>
                                    <td>0.83</td>
                                    <td>0.00</td>
                                    <td>0.92</td>
                                    <td>0.05</td>
                                    <td>1.00</td>
                                    <td>0.49</td>
                                </tr>
                                <tr class="avg-row" style="background: #f0f0f0; font-weight: bold;">
                                    <td class="slr-name">MOYENNE (14 SLR)</td>
                                    <td style="text-align: center;">-</td>
                                    <td style="background: #d0e5f5;">0.85</td>
                                    <td style="background: #d0e5f5;">0.43</td>
                                    <td style="background: #d4edda;">0.72</td>
                                    <td style="background: #d4edda;">0.66</td>
                                    <td style="background: #e1bee7;">0.81</td>
                                    <td style="background: #e1bee7;">0.50</td>
                                    <td style="background: #ffe0b2;">0.86</td>
                                    <td style="background: #ffe0b2;">0.44</td>
                                    <td style="background: #f3e5f5;">0.51</td>
                                    <td style="background: #f3e5f5;">0.44</td>
                                    <td style="background: #b2dfdb;">0.81</td>
                                    <td style="background: #b2dfdb;">0.49</td>
                                    <td style="background: #c8e6c9;">0.73</td>
                                    <td style="background: #c8e6c9;">0.62</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Observations multi-mod√®les -->
                    <div style="margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                        <div style="padding: 15px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #5a9bd5;">
                            <h4 style="color: #1565C0; margin-bottom: 8px; font-size: 0.95em;">Q3=2 (Coll√®gue)</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.85 | <strong>TNR:</strong> 0.43</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Excellent TPR, TNR faible</p>
                        </div>
                        
                        <div style="padding: 15px; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #70ad47;">
                            <h4 style="color: #2E7D32; margin-bottom: 8px; font-size: 0.95em;">Q3+S (Coll√®gue)</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.72 | <strong>TNR:</strong> 0.66</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Bon √©quilibre</p>
                        </div>
                        
                        <div style="padding: 15px; background: #f3e5f5; border-radius: 8px; border-left: 4px solid #b39ddb;">
                            <h4 style="color: #7b1fa2; margin-bottom: 8px; font-size: 0.95em;">ML</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.81 | <strong>TNR:</strong> 0.50</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Bon TPR, TNR moyen</p>
                        </div>
                        
                        <div style="padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ff9800;">
                            <h4 style="color: #f57c00; margin-bottom: 8px; font-size: 0.95em;">Qwen (Massinissa)</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> <strong>0.86 ü•á</strong> | <strong>TNR:</strong> 0.44</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Meilleur TPR, TNR faible</p>
                        </div>
                        
                        <div style="padding: 15px; background: #fce4ec; border-radius: 8px; border-left: 4px solid #ab47bc;">
                            <h4 style="color: #7b1fa2; margin-bottom: 8px; font-size: 0.95em;">Qwen Canada</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.51 | <strong>TNR:</strong> 0.44</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Performances faibles</p>
                        </div>
                        
                        <div style="padding: 15px; background: #e0f2f1; border-radius: 8px; border-left: 4px solid #26a69a;">
                            <h4 style="color: #00796b; margin-bottom: 8px; font-size: 0.95em;">GPT-4o</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.81 | <strong>TNR:</strong> 0.49</p>
                            <p style="font-size: 0.85em; color: #666; margin-top: 8px;">Similaire √† ML</p>
                        </div>
                        
                        <div style="padding: 15px; background: #c8e6c9; border-radius: 8px; border-left: 4px solid #4CAF50; border: 2px solid #4CAF50;">
                            <h4 style="color: #1B5E20; margin-bottom: 8px; font-size: 0.95em;">üéØ Votre P3-QW</h4>
                            <p style="margin: 3px 0; font-size: 0.9em;"><strong>TPR:</strong> 0.73 | <strong>TNR:</strong> <strong>0.62 ü•á</strong></p>
                            <p style="font-size: 0.85em; font-weight: bold; color: #1B5E20; margin-top: 8px;">Meilleur √©quilibre global</p>
                        </div>
                    </div>

                    <!-- Note sur les r√©sultats atypiques -->
                    <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                        <p style="color: #856404; margin: 0;"><strong>‚ö†Ô∏è Notes importantes :</strong></p>
                        <ul style="color: #856404; margin: 10px 0 0 20px;">
                            <li>Les SLR <strong>Tachy_SOTA_LW</strong> et <strong>Teranga_2023_LW</strong> pr√©sentent des r√©sultats atypiques pour P3-QW (TPR ~2-6%) et Q3+S</li>
                            <li>Sur les 12 autres SLR, <strong>P3-QW maintient le meilleur TNR (0.62) de tous les mod√®les</strong></li>
                            <li><strong>P3-QW et Q3+S sont les seuls mod√®les √† approcher l'objectif TNR ‚â• 70%</strong></li>
                            <li><strong>Qwen (Massinissa) obtient le meilleur TPR global (0.86)</strong> mais au d√©triment du TNR</li>
                        </ul>
                    </div>
                </div>

                <!-- TABLEAU 11 SLR (Sans les r√©sultats atypiques) -->
                <div class="section">
                    <h2>üìã R√©sultats - 11 SLR (Sans cas atypiques)</h2>
                    
                    <p style="margin-bottom: 20px; color: #666;">
                        Ce tableau exclut les SLR Tachy_SOTA_LW, Teranga_2023_LW et SOTA_ICD_BS qui pr√©sentent des r√©sultats atypiques ou peu repr√©sentatifs (n=6).
                    </p>

                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th rowspan="2" style="min-width: 250px;">SLR</th>
                                    <th rowspan="2" style="background: #e8eaf6;">Taille</th>
                                    <th colspan="2" style="background: #5a9bd5;">Picos-ref</th>
                                    <th colspan="2" style="background: #70ad47;">PICOS+SUJET</th>
                                    <th colspan="2" style="background: #b39ddb;">ML</th>
                                    <th colspan="2" style="background: #ff9800;">Qwen<br>(Mass.)</th>
                                    <th colspan="2" style="background: #ab47bc;">Qwen<br>Canada</th>
                                    <th colspan="2" style="background: #26a69a;">GPT-4o</th>
                                    <th colspan="2" style="background: #4CAF50;">P3<br>(Marie)</th>
                                </tr>
                                <tr>
                                    <th style="background: #5a9bd5;">TPR</th>
                                    <th style="background: #5a9bd5;">TNR</th>
                                    <th style="background: #70ad47;">TPR</th>
                                    <th style="background: #70ad47;">TNR</th>
                                    <th style="background: #b39ddb;">TPR</th>
                                    <th style="background: #b39ddb;">TNR</th>
                                    <th style="background: #ff9800;">TPR</th>
                                    <th style="background: #ff9800;">TNR</th>
                                    <th style="background: #ab47bc;">TPR</th>
                                    <th style="background: #ab47bc;">TNR</th>
                                    <th style="background: #26a69a;">TPR</th>
                                    <th style="background: #26a69a;">TNR</th>
                                    <th style="background: #4CAF50;">TPR</th>
                                    <th style="background: #4CAF50;">TNR</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="slr-name">CICATRYL_SOTA_SD</td>
                                    <td style="text-align: center;">147</td>
                                    <td>0.87</td>
                                    <td>0.50</td>
                                    <td>0.83</td>
                                    <td>0.68</td>
                                    <td>0.24</td>
                                    <td>0.82</td>
                                    <td>0.87</td>
                                    <td>0.50</td>
                                    <td>0.49</td>
                                    <td>0.50</td>
                                    <td>0.90</td>
                                    <td>0.68</td>
                                    <td>0.80</td>
                                    <td>0.75</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">CLINICAL_DATA_RM_GM</td>
                                    <td style="text-align: center;">25</td>
                                    <td>1.00</td>
                                    <td>0.17</td>
                                    <td>1.00</td>
                                    <td>0.34</td>
                                    <td>1.00</td>
                                    <td>0.43</td>
                                    <td>1.00</td>
                                    <td>0.17</td>
                                    <td>0.50</td>
                                    <td>0.40</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>1.00</td>
                                    <td>0.22</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">DIA_LARM_BS</td>
                                    <td style="text-align: center;">68</td>
                                    <td>0.72</td>
                                    <td>0.62</td>
                                    <td>0.83</td>
                                    <td>0.55</td>
                                    <td>0.75</td>
                                    <td>0.46</td>
                                    <td>1.00</td>
                                    <td>0.51</td>
                                    <td>0.33</td>
                                    <td>0.51</td>
                                    <td>0.17</td>
                                    <td>0.85</td>
                                    <td>0.92</td>
                                    <td>0.82</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">LUNG_CANCER_LB</td>
                                    <td style="text-align: center;">218</td>
                                    <td>0.96</td>
                                    <td>0.62</td>
                                    <td>0.94</td>
                                    <td>0.71</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>0.98</td>
                                    <td>0.69</td>
                                    <td>0.50</td>
                                    <td>0.63</td>
                                    <td>0.94</td>
                                    <td>0.63</td>
                                    <td>0.91</td>
                                    <td>0.74</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">PCL_EL</td>
                                    <td style="text-align: center;">215</td>
                                    <td>0.48</td>
                                    <td>0.77</td>
                                    <td>0.48</td>
                                    <td>0.87</td>
                                    <td>0.72</td>
                                    <td>0.33</td>
                                    <td>0.45</td>
                                    <td>0.80</td>
                                    <td>0.31</td>
                                    <td>0.78</td>
                                    <td>0.28</td>
                                    <td>0.90</td>
                                    <td>0.38</td>
                                    <td>0.88</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">REVIEW_HRV_ACIDOSE_AW</td>
                                    <td style="text-align: center;">801</td>
                                    <td>1.00</td>
                                    <td>0.36</td>
                                    <td>0.86</td>
                                    <td>0.65</td>
                                    <td>1.00</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.36</td>
                                    <td>0.64</td>
                                    <td>0.34</td>
                                    <td>1.00</td>
                                    <td>0.59</td>
                                    <td>0.92</td>
                                    <td>0.66</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">REVIEW_RESORBABLE_POLYCAPROLACTONE_EL</td>
                                    <td style="text-align: center;">185</td>
                                    <td>0.91</td>
                                    <td>0.44</td>
                                    <td>0.93</td>
                                    <td>0.48</td>
                                    <td>0.64</td>
                                    <td>0.60</td>
                                    <td>0.95</td>
                                    <td>0.64</td>
                                    <td>0.63</td>
                                    <td>0.48</td>
                                    <td>0.98</td>
                                    <td>0.57</td>
                                    <td>0.95</td>
                                    <td>0.41</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">SOTA_ICD_COMPR_BS</td>
                                    <td style="text-align: center;">33</td>
                                    <td>0.77</td>
                                    <td>0.25</td>
                                    <td>0.85</td>
                                    <td>0.55</td>
                                    <td>0.90</td>
                                    <td>0.45</td>
                                    <td>0.77</td>
                                    <td>0.25</td>
                                    <td>0.77</td>
                                    <td>0.35</td>
                                    <td>1.00</td>
                                    <td>0.00</td>
                                    <td>0.85</td>
                                    <td>0.60</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">SOTA_RM_GH</td>
                                    <td style="text-align: center;">172</td>
                                    <td>1.00</td>
                                    <td>0.02</td>
                                    <td>1.00</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.52</td>
                                    <td>1.00</td>
                                    <td>0.13</td>
                                    <td>0.77</td>
                                    <td>0.30</td>
                                    <td>1.00</td>
                                    <td>0.01</td>
                                    <td>0.95</td>
                                    <td>0.27</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">Spring_thread_LW</td>
                                    <td style="text-align: center;">217</td>
                                    <td>0.94</td>
                                    <td>0.55</td>
                                    <td>0.82</td>
                                    <td>0.79</td>
                                    <td>0.94</td>
                                    <td>0.56</td>
                                    <td>0.94</td>
                                    <td>0.55</td>
                                    <td>0.44</td>
                                    <td>0.58</td>
                                    <td>0.96</td>
                                    <td>0.57</td>
                                    <td>0.72</td>
                                    <td>0.87</td>
                                </tr>
                                <tr>
                                    <td class="slr-name">WHEELCHAIR_BS</td>
                                    <td style="text-align: center;">51</td>
                                    <td>1.00</td>
                                    <td>0.31</td>
                                    <td>0.41</td>
                                    <td>0.84</td>
                                    <td>0.67</td>
                                    <td>0.62</td>
                                    <td>1.00</td>
                                    <td>0.08</td>
                                    <td>0.83</td>
                                    <td>0.00</td>
                                    <td>0.92</td>
                                    <td>0.05</td>
                                    <td>1.00</td>
                                    <td>0.49</td>
                                </tr>
                                <tr class="avg-row" style="background: #f0f0f0; font-weight: bold;">
                                    <td class="slr-name">MOYENNE (11 SLR)</td>
                                    <td style="text-align: center;">-</td>
                                    <td style="background: #d0e5f5;"><strong>0.88</strong></td>
                                    <td style="background: #d0e5f5;">0.42</td>
                                    <td style="background: #d4edda;">0.84</td>
                                    <td style="background: #d4edda;"><strong>0.62</strong></td>
                                    <td style="background: #e1bee7;">0.81</td>
                                    <td style="background: #e1bee7;">0.46</td>
                                    <td style="background: #ffe0b2;"><strong>0.90</strong></td>
                                    <td style="background: #ffe0b2;">0.43</td>
                                    <td style="background: #f3e5f5;">0.57</td>
                                    <td style="background: #f3e5f5;">0.44</td>
                                    <td style="background: #b2dfdb;">0.83</td>
                                    <td style="background: #b2dfdb;">0.49</td>
                                    <td style="background: #c8e6c9;">0.86</td>
                                    <td style="background: #c8e6c9;"><strong>0.61</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Observations sur 11 SLR -->
                    <div style="margin-top: 30px; padding: 20px; background: #e8f5e9; border-radius: 10px; border-left: 5px solid #4CAF50;">
                        <h3 style="color: #2E7D32; margin-bottom: 15px;">üìä Observations sur les 11 SLR (sans cas atypiques)</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="padding: 12px; background: white; border-radius: 8px;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #5a9bd5;">Picos-ref:</strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.88 | TNR: 0.42</p>
                                <p style="font-size: 0.8em; color: #666; margin-top: 3px;">Excellent TPR</p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px; border: 2px solid #70ad47;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #70ad47;">PICOS+SUJET:</strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.84 | TNR: 0.62 ü•á</p>
                                <p style="font-size: 0.8em; color: #2E7D32; margin-top: 3px;"><strong>Meilleur TNR</strong></p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #ff9800;">Qwen (Mass.):</strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.90 ü•á | TNR: 0.43</p>
                                <p style="font-size: 0.8em; color: #666; margin-top: 3px;">Meilleur TPR</p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #26a69a;">GPT-4o:</strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.83 | TNR: 0.49</p>
                                <p style="font-size: 0.8em; color: #666; margin-top: 3px;">Performance moyenne</p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px; border: 2px solid #4CAF50;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #4CAF50;">P3-Marie:</strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.86 | TNR: 0.61 ü•à</p>
                                <p style="font-size: 0.8em; color: #2E7D32; margin-top: 3px;"><strong>Excellent √©quilibre</strong></p>
                            </div>
                            <div style="padding: 12px; background: white; border-radius: 8px; border: 2px solid #4CAF50;">
                                <p style="margin: 0; font-size: 0.9em;"><strong style="color: #4CAF50;">Elicit Dialarm </strong></p>
                                <p style="margin: 5px 0; font-size: 0.85em;">TPR: 0.75 | TNR: 0.872 </p>
                                <p style="font-size: 0.8em; color: #2E7D32; margin-top: 3px;"><strong>Excellent √©quilibre</strong></p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid #4CAF50;">
                            <p style="margin: 0; font-size: 0.95em; color: #2E7D32;">
                                <strong>üí° Conclusion sur 11 SLR :</strong>
                            </p>
                            <ul style="margin: 10px 0 0 20px; color: #2E7D32; font-size: 0.9em;">
                                <li><strong>PICOS+SUJET</strong> obtient le meilleur TNR (0.62) et le meilleur √©quilibre global</li>
                                <li><strong>P3-Marie</strong> arrive juste derri√®re avec TNR = 0.61 et un TPR sup√©rieur (0.86 vs 0.84)</li>
                                <li><strong>Qwen (Mass.)</strong> obtient le meilleur TPR (0.90) mais un TNR faible (0.43)</li>
                                <li><strong>P3-Marie et PICOS+SUJET</strong> sont les seuls √† approcher l'objectif TNR ‚â• 70%</li>
                            </ul>
                        </div>
                    </div>
                </div>


            
            </div>


        <!-- ANNEXE - PROMPTS COMPLETS -->
        <div class="section" style="page-break-before: always;">
            <h2>üìã Annexe - Texte Complet des Prompts Test√©s</h2>
            
            <p style="margin-bottom: 30px; font-style: italic; color: #666;">
                Cette annexe contient le texte int√©gral de tous les prompts d√©velopp√©s et test√©s dans le cadre de cette √©tude comparative.
            </p>

            <!-- PROMPT  -->
            <div style="margin-bottom: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #70ad47;">
                <h3 style="color: #70ad47; margin-bottom: 15px;">üìù Prompt Canada</h3>
                <p><strong>Objectif :</strong> Approche par √©chelle de gradation</p>

                <div style="margin-top: 15px; padding: 20px; background: white; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6; overflow-x: auto;">
                    <pre style="margin: 0; white-space: pre-wrap;">
                        """You are a researcher rigorously screening titles and abstracts of scientific papers for
                        inclusion or exclusion in a review paper. Based on the following article title and abstract,
                        and the inclusion criteria provided, determine how likely this article is to be relevant.
                         
                        INCLUSION CRITERIA:
                        - Population: {population}
                        - Indication: {indication}
                        - Intervention: {intervention}
                        - Comparison: {comparison}
                        - Outcomes: {outcome}
                         
                        EXCLUSION CRITERIA:
                        Studies explicitly about {excludes} are always excluded.
                         
                        ARTICLE TO SCREEN:
                        Title: {title}
                        Abstract: {abstract}
                         
                        Based on your assessment, determine the likelihood of relevance using ONE of these exact phrases:
                        - "Almost certain"
                        - "Extremely likely"
                        - "Very likely"
                        - "Likely"
                        - "About as likely as not"
                        - "Unlikely"
                        - "Very unlikely"
                        - "Extremely unlikely"
                        - "Almost impossible"
                        """</pre>
                </div>
            </div>


            <!-- PROMPT -->
            <div style="margin-bottom: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #70ad47;">
                <h3 style="color: #70ad47; margin-bottom: 15px;">Picos-ref (que picos Massinissa) </h3>
                <div style="margin-top: 15px; padding: 20px; background: white; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6; overflow-x: auto;">
                    <pre style="margin: 0; white-space: pre-wrap;">
                                user_prompt = f"""
                        Task: Screen the article vs PICOS. Return ONLY one JSON object.
                        
                        Title: {title}
                        Abstract: {abstract}
                        
                        - Decision Rules:
                        * Include ("Decision": "1") if:
                            - The study clearly matches ** MOST ** inclusion criteria
                            - Indication category, if present, is a strong match
                            - Similar concepts or procedures are described
                            - No major inclusion criteria are explicitly contradicted
                            - No clear exclusion criteria are met
                        * Exclude ("Decision": "0") if:
                            - The study clearly contradicts key inclusion criteria
                            - OR matches any explicit exclusion criteria
                        
                        Rules you must follow when producing the JSON:
                        - For each PICOS category (Population, Intervention, Indication, Comparators, Outcomes, Study TYPE) list ONLY the matched term(s)
                        extracted from the title or abstract. If none matched, write \"no match\".
                        - If you use a synonym or related mapping, show the original found text followed by \"-> maps_to (target)\".
                        - Do NOT repeat the full criteria lists, do NOT output items that were not found in the text.
                        
                        Return JSON schema:
                        {{
                        \"Decision\": \"1\" or \"0\",
                        \"Justification\": [
                            \"Population: <found terms or no match>\",
                            \"Intervention: <found terms or no match>\",
                            \"Indication: <found terms or no match>\",
                            \"Comparators: <found terms or no match>\",
                            \"Outcomes: <found terms or no match>\",
                            \"Study Type: <found terms or no match>\"
                        ]
                        }}
                        
                        Inclusion PICOS (for reference, DO NOT repeat):
                        Inclusion Population: {picos['Inclusion POPULATION']}
                        Inclusion Intervention: {picos['Inclusion INTERVENTION']}
                        Inclusion Indication: {picos['Inclusion INDICATION']}
                        Inclusion Comparators: {picos['Inclusion COMPARATORS']}
                        Inclusion Outcomes: {picos['Inclusion OUTCOMES']}
                        Inclusion Study Type: {picos['Inclusion STUDY TYPE']}
                        
                        Exclusion PICOS (for reference, DO NOT repeat):
                        Exclusion Population: {picos['Exclusion POPULATION']}
                        Exclusion Intervention: {picos['Exclusion INTERVENTION']}
                        Exclusion Indication: {picos['Exclusion INDICATION']}
                        Exclusion Comparators: {picos['Exclusion COMPARATORS']}
                        Exclusion Outcomes: {picos['Exclusion OUTCOMES'] }
                        Exclusion Study Type: {picos['Exclusion STUDY TYPE']}
                        """
                    </pre>
                </div>
            </div>

            <!-- PROMPT 3 -->
            <div style="margin-bottom: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #4CAF50;">
                <h3 style="color: #4CAF50; margin-bottom: 15px;">üìù Prompt 3 - Optimis√© pour le Recall (PICOS seul)</h3>
                <p><strong>Objectif :</strong> Maximiser la sensibilit√© avec gestion des n√©gations et scoring adaptatif</p>
                <p><strong>Mod√®les test√©s :</strong> Qwen | <strong>R√©sultats :</strong> ML: TPR=0.79, TNR=0.46 | <strong style="color: #4CAF50;">Qwen: TPR=0.84 ‚úì, TNR=0.52</strong></p>
                
                <div style="margin-top: 15px; padding: 20px; background: white; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6; overflow-x: auto;">
                    <pre style="margin: 0; white-space: pre-wrap;">system_msg = (
            "You are a screening assistant.\n"
            "Return EXACTLY one JSON object and NOTHING else.\n"
            "List ONLY verbatim matches from Title/Abstract per PICOS category.\n"
            "If mapping via synonym, use 'found_term -> maps_to (criterion)'.\n"
            "If no match, write 'no match'. Handle negations within ¬±20 chars.\n"
            "Trigger exclusion ONLY on clear non-negated matches to critical exclusions."
        )

        user_prompt = f"""
        Task: Screen the article vs PICOS. Output ONLY one JSON object.
        Title: {t}
        Abstract: {a}

        Decision policy:
        1) Critical exclusions first: if a clear, non-negated match to ANY of [{excl_str}] ‚Üí Decision="0".
        2) Inclusion scoring:
        - +1 for each PICOS category with ‚â•1 positive match (Population, Intervention, Indication, Comparators, Outcomes, StudyType).
        - +{BONUS_IND_INT} extra if Indication AND Intervention both match.
        - 0 if "no match" or only negated mentions.
        3) Threshold:
        - If score ‚â• {INCLUDE_THRESHOLD} and no critical exclusion ‚Üí Decision="1"
        - Else ‚Üí Decision="0"

        If uncertain but relevant to the research topic, favor inclusion during matching.

        Output (single JSON object):
        {{
        "Decision": "1" | "0",
        "Score": <int>,
        "Matches": {{
            "Population": [{{"text":"<verbatim>","negated":true|false,"mapping":"<optional>"}}]] | "no match",
            "Intervention": [ ... ] | "no match",
            "Indication": [ ... ] | "no match",
            "Comparators": [ ... ] | "no match",
            "Outcomes": [ ... ] | "no match",
            "StudyType": [ ... ] | "no match"
        }},
        "ExclusionsTriggered": [{{"text":"<verbatim>","reason":"<critical exclusion>"}}] | []
        }}

        Reference PICOS (do NOT repeat contents; only use for matching):
        Research question: {topic}
        Inclusion Population: {picos_prompt['Inclusion POPULATION']}
        Inclusion Intervention: {picos_prompt['Inclusion INTERVENTION']}
        Inclusion Indication: {picos_prompt['Inclusion INDICATION']}
        Inclusion Comparators: {picos_prompt['Inclusion COMPARATORS']}
        Inclusion Outcomes: {picos_prompt['Inclusion OUTCOMES']}
        Inclusion Study Type: {picos_prompt['Inclusion STUDY TYPE']}
        Exclusion Population: {picos_prompt['Exclusion POPULATION']}
        Exclusion Intervention: {picos_prompt['Exclusion INTERVENTION']}
        Exclusion Indication: {picos_prompt['Exclusion INDICATION']}
        Exclusion Comparators: {picos_prompt['Exclusion COMPARATORS']}
        Exclusion Outcomes: {picos_prompt['Exclusion OUTCOMES']}
        Exclusion Study Type: {picos_prompt['Exclusion STUDY TYPE']}
        """

        return f"<<SYSTEM>>\n{system_msg}\n<</SYSTEM>>\n\n{user_prompt}".strip()</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data with Prompt3 and Prompt3+Subject (Qwen only)
        const slrData = [
            {name: "DIA LARM BS", q32_tpr: 0.72, q32_tnr: 0.62, q3s_tpr: 0.83, q3s_tnr: 0.55, p1qw_tpr: 0.39, p1qw_tnr: 0.88, p2qw_tpr: 0.06, p2qw_tnr: 1.00, p3qw_tpr: 0.92, p3qw_tnr: 0.82, p3sqw_tpr: 0.92, p3sqw_tnr: 0.68, p4qw_tpr: 1.00, p4qw_tnr: 0.71},
            {name: "LUNG CANCER LB", q32_tpr: 0.96, q32_tnr: 0.62, q3s_tpr: 0.94, q3s_tnr: 0.71, p1qw_tpr: 0.94, p1qw_tnr: 0.62, p2qw_tpr: 0.89, p2qw_tnr: 0.87, p3qw_tpr: 0.91, p3qw_tnr: 0.74, p3sqw_tpr: 0.69, p3sqw_tnr: 0.93, p4qw_tpr: 0.73, p4qw_tnr: 0.92},
            {name: "PCL EL", q32_tpr: 0.48, q32_tnr: 0.77, q3s_tpr: 0.48, q3s_tnr: 0.87, p1qw_tpr: 0.48, p1qw_tnr: 0.77, p2qw_tpr: 0.24, p2qw_tnr: 0.92, p3qw_tpr: 0.38, p3qw_tnr: 0.88, p3sqw_tpr: 0.34, p3sqw_tnr: 0.85, p4qw_tpr: 0.57, p4qw_tnr: 0.87},
            {name: "REVIEW RESORBABLE POLYCAPROLACTONE EL", q32_tpr: 0.91, q32_tnr: 0.44, q3s_tpr: 0.93, q3s_tnr: 0.48, p1qw_tpr: 0.91, p1qw_tnr: 0.44, p2qw_tpr: 0.75, p2qw_tnr: 0.75, p3qw_tpr: 0.95, p3qw_tnr: 0.41, p3sqw_tpr: 0.95, p3sqw_tnr: 0.40, p4qw_tpr: 0.91, p4qw_tnr: 0.45},
            {name: "SOTA ICD BS", q32_tpr: 0.75, q32_tnr: 0.00, q3s_tpr: 1.00, q3s_tnr: 0.50, p1qw_tpr: 0.75, p1qw_tnr: 0.00, p2qw_tpr: 0.50, p2qw_tnr: 0.50, p3qw_tpr: 0.75, p3qw_tnr: 0.00, p3sqw_tpr: 0.50, p3sqw_tnr: 0.50, p4qw_tpr: 0.50, p4qw_tnr: 0.50},
            {name: "SOTA RM GH", q32_tpr: 1.00, q32_tnr: 0.02, q3s_tpr: 1.00, q3s_tnr: 0.30, p1qw_tpr: 1.00, p1qw_tnr: 0.02, p2qw_tpr: 1.00, p2qw_tnr: 0.42, p3qw_tpr: 0.95, p3qw_tnr: 0.27, p3sqw_tpr: 0.95, p3sqw_tnr: 0.40, p4qw_tpr: 0.86, p4qw_tnr: 0.59},
            {name: "WHEELCHAIR BS", q32_tpr: 1.00, q32_tnr: 0.31, q3s_tpr: 0.41, q3s_tnr: 0.84, p1qw_tpr: 1.00, p1qw_tnr: 0.31, p2qw_tpr: 0.58, p2qw_tnr: 0.62, p3qw_tpr: 1.00, p3qw_tnr: 0.49, p3sqw_tpr: 0.75, p3sqw_tnr: 0.62, p4qw_tpr: 0.83, p4qw_tnr: 0.62}
        ];

        // Populate table
        const tbody = document.getElementById('slr-table-body');
        let sum_q32_tpr = 0, sum_q32_tnr = 0, sum_q3s_tpr = 0, sum_q3s_tnr = 0;
        let sum_p1qw_tpr = 0, sum_p1qw_tnr = 0, sum_p2qw_tpr = 0, sum_p2qw_tnr = 0;
        let sum_p3qw_tpr = 0, sum_p3qw_tnr = 0, sum_p3sqw_tpr = 0, sum_p3sqw_tnr = 0;
        let sum_p4qw_tpr = 0, sum_p4qw_tnr = 0;
        let count_q32 = 0, count_q3s = 0, count_p1qw = 0, count_p2qw = 0;
        let count_p3qw = 0, count_p3sqw = 0, count_p4qw = 0;

        slrData.forEach(slr => {
            const row = tbody.insertRow();
            const cells = [
                slr.name,
                slr.q32_tpr !== null ? slr.q32_tpr.toFixed(2) : '-',
                slr.q32_tnr !== null ? slr.q32_tnr.toFixed(2) : '-',
                slr.q3s_tpr !== null ? slr.q3s_tpr.toFixed(2) : '-',
                slr.q3s_tnr !== null ? slr.q3s_tnr.toFixed(2) : '-',
                slr.p1qw_tpr !== null ? slr.p1qw_tpr.toFixed(2) : '-',
                slr.p1qw_tnr !== null ? slr.p1qw_tnr.toFixed(2) : '-',
                slr.p2qw_tpr !== null ? slr.p2qw_tpr.toFixed(2) : '-',
                slr.p2qw_tnr !== null ? slr.p2qw_tnr.toFixed(2) : '-',
                slr.p3qw_tpr !== null ? slr.p3qw_tpr.toFixed(2) : '-',
                slr.p3qw_tnr !== null ? slr.p3qw_tnr.toFixed(2) : '-',
                slr.p3sqw_tpr !== null ? slr.p3sqw_tpr.toFixed(2) : '-',
                slr.p3sqw_tnr !== null ? slr.p3sqw_tnr.toFixed(2) : '-',
                slr.p4qw_tpr !== null ? slr.p4qw_tpr.toFixed(2) : '-',
                slr.p4qw_tnr !== null ? slr.p4qw_tnr.toFixed(2) : '-'
            ];
            
            cells.forEach((cell, idx) => {
                const td = row.insertCell();
                td.textContent = cell;
                if (idx === 0) {
                    td.className = 'slr-name';
                } else if (idx >= 7 && idx <= 8) {
                    td.style.background = '#fef5e7';
                } else if (idx >= 9 && idx <= 10) {
                    td.style.background = '#e8f5e9';
                } else if (idx >= 11 && idx <= 12) {
                    td.style.background = '#c8e6c9';
                } else if (idx >= 13) {
                    td.style.background = '#e1f5fe';
                }
            });
            
            if (slr.q32_tpr !== null) { sum_q32_tpr += slr.q32_tpr; count_q32++; }
            if (slr.q32_tnr !== null) sum_q32_tnr += slr.q32_tnr;
            if (slr.q3s_tpr !== null) { sum_q3s_tpr += slr.q3s_tpr; count_q3s++; }
            if (slr.q3s_tnr !== null) sum_q3s_tnr += slr.q3s_tnr;
            if (slr.p1qw_tpr !== null) { sum_p1qw_tpr += slr.p1qw_tpr; count_p1qw++; }
            if (slr.p1qw_tnr !== null) sum_p1qw_tnr += slr.p1qw_tnr;
            if (slr.p2qw_tpr !== null) { sum_p2qw_tpr += slr.p2qw_tpr; count_p2qw++; }
            if (slr.p2qw_tnr !== null) sum_p2qw_tnr += slr.p2qw_tnr;
            if (slr.p3qw_tpr !== null) { sum_p3qw_tpr += slr.p3qw_tpr; count_p3qw++; }
            if (slr.p3qw_tnr !== null) sum_p3qw_tnr += slr.p3qw_tnr;
            if (slr.p3sqw_tpr !== null) { sum_p3sqw_tpr += slr.p3sqw_tpr; count_p3sqw++; }
            if (slr.p3sqw_tnr !== null) sum_p3sqw_tnr += slr.p3sqw_tnr;
            if (slr.p4qw_tpr !== null) { sum_p4qw_tpr += slr.p4qw_tpr; count_p4qw++; }
            if (slr.p4qw_tnr !== null) sum_p4qw_tnr += slr.p4qw_tnr;
        });

        // Add average row
        const avgRow = tbody.insertRow();
        avgRow.className = 'avg-row';
        const avgCells = [
            'MOYENNE',
            count_q32 > 0 ? (sum_q32_tpr / count_q32).toFixed(2) : '-',
            count_q32 > 0 ? (sum_q32_tnr / count_q32).toFixed(2) : '-',
            count_q3s > 0 ? (sum_q3s_tpr / count_q3s).toFixed(2) : '-',
            count_q3s > 0 ? (sum_q3s_tnr / count_q3s).toFixed(2) : '-',
            count_p1qw > 0 ? (sum_p1qw_tpr / count_p1qw).toFixed(2) : '-',
            count_p1qw > 0 ? (sum_p1qw_tnr / count_p1qw).toFixed(2) : '-',
            count_p2qw > 0 ? (sum_p2qw_tpr / count_p2qw).toFixed(2) : '-',
            count_p2qw > 0 ? (sum_p2qw_tnr / count_p2qw).toFixed(2) : '-',
            count_p3qw > 0 ? (sum_p3qw_tpr / count_p3qw).toFixed(2) : '-',
            count_p3qw > 0 ? (sum_p3qw_tnr / count_p3qw).toFixed(2) : '-',
            count_p3sqw > 0 ? (sum_p3sqw_tpr / count_p3sqw).toFixed(2) : '-',
            count_p3sqw > 0 ? (sum_p3sqw_tnr / count_p3sqw).toFixed(2) : '-',
            count_p4qw > 0 ? (sum_p4qw_tpr / count_p4qw).toFixed(2) : '-',
            count_p4qw > 0 ? (sum_p4qw_tnr / count_p4qw).toFixed(2) : '-'
        ];
        
        avgCells.forEach((cell, idx) => {
            const td = avgRow.insertCell();
            td.textContent = cell;
            if (idx === 0) {
                td.className = 'slr-name';
            } else if (idx >= 7 && idx <= 8) {
                td.style.background = '#f39c12';
                td.style.color = 'white';
                td.style.fontWeight = 'bold';
            } else if (idx >= 9 && idx <= 10) {
                td.style.background = '#4CAF50';
                td.style.color = 'white';
                td.style.fontWeight = 'bold';
            } else if (idx >= 11 && idx <= 12) {
                td.style.background = '#388E3C';
                td.style.color = 'white';
                td.style.fontWeight = 'bold';
            } else if (idx >= 13) {
                td.style.background = '#2196F3';
                td.style.color = 'white';
                td.style.fontWeight = 'bold';
            }
        });

        // Export to PDF function
        function exportToPDF() {
            const button = document.querySelector('.export-btn');
            button.textContent = '‚è≥ G√©n√©ration en cours...';
            button.disabled = true;

            const element = document.getElementById('report-content');
            const opt = {
                margin: 10,
                filename: 'Rapport_Comparaison_SLR_Complet.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                button.innerHTML = `
                    <svg fill="currentColor" viewBox="0 0 20 20">
                        <path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/>
                    </svg>
                    Exporter en PDF
                `;
                button.disabled = false;
            });
        }
    </script>
</body>
</html>
